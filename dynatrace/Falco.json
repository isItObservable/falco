{"version":15,"variables":[],"tiles":{"0":{"type":"markdown","title":"","content":"**Falco Agents**"},"1":{"type":"data","title":"Number of Falco Agents","query":"fetch dt.entity.cloud_application_instance\n| fieldsAdd workload_label=cloudApplicationLabels\n| filter workload_label[`app.kubernetes.io/name`] == \"falco\"\n| summarize count()\n","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","categoricalBarChartSettings":{}},"singleValue":{"showLabel":false,"label":"","prefixIcon":"","recordField":"count()","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical","dataMappings":{},"displayedFields":[]},"histogram":{"dataMappings":[{"valueAxis":"count()","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"2":{"type":"data","title":"Cpu health","query":"timeseries cpu_usages = avg(dt.kubernetes.container.cpu_usage),cpu_limit=avg(dt.kubernetes.container.limits_cpu), by:{ k8s.workload.name, k8s.pod.name}\n| fieldsAdd cpu_ratio =( cpu_usages[]/cpu_limit[])*100\n| fieldsAdd cpu=arrayAvg(cpu_ratio)\n|filter k8s.workload.name==\"falco\"\n| fieldsRemove cpu_usages,cpu_limit,cpu_ratio","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"honeycomb","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"k8s.workload.name","categoryAxisLabel":"k8s.workload.name","valueAxis":["cpu"],"valueAxisLabel":"cpu","tooltipVariant":"single"},"hiddenLegendFields":["k8s.workload","k8s.pod"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["interval"],"leftAxisDimensions":["k8s.workload.name"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"k8s.workload.name","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"bottom"},"colorMode":"color-palette","colorPalette":"red","dataMappings":{"value":"cpu"},"displayedFields":["k8s.pod.name"]},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""},{"valueAxis":"cpu","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"3":{"type":"data","title":"memory health","query":"timeseries cpu_usages = avg(dt.kubernetes.container.memory_working_set),cpu_limit=avg(dt.kubernetes.container.limits_memory), by:{ k8s.workload.name, k8s.pod.name}\n| fieldsAdd cpu_ratio =( cpu_usages[]/cpu_limit[])*100\n| fieldsAdd memory=arrayAvg(cpu_ratio)\n|filter k8s.workload.name==\"falco\"\n| fieldsRemove cpu_usages,cpu_limit,cpu_ratio","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"honeycomb","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"k8s.workload.name","categoryAxisLabel":"k8s.workload.name","valueAxis":["memory"],"valueAxisLabel":"memory","tooltipVariant":"single"},"hiddenLegendFields":["k8s.workload","k8s.pod"],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["interval"],"leftAxisDimensions":["k8s.workload.name"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"k8s.workload.name","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"bottom"},"colorMode":"color-palette","colorPalette":"red","dataMappings":{"value":"memory"},"displayedFields":["k8s.pod.name"]},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""},{"valueAxis":"memory","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"4":{"type":"data","title":"Rules","query":"timeseries avg(falco_events), by: { rule }\n| limit 20","queryConfig":{"version":"11.2.0","subQueries":[{"id":"A","isEnabled":true,"limit":20,"filter":"","datatype":"metrics","metric":{"key":"falco_events","aggregation":"avg"},"by":["rule"]}]},"subType":"dql-builder-metrics","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"rule","categoryAxisLabel":"rule","valueAxis":["interval"],"valueAxisLabel":"interval","tooltipVariant":"single"},"hiddenLegendFields":[],"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(falco_events)"],"leftAxisDimensions":["rule"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"rule_name","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"interval"},"displayedFields":["rule"]},"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]}},"davis":{},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"5":{"type":"markdown","title":"","content":"**Falco Rules**"},"6":{"type":"data","title":"Events per Namespaces","query":"fetch logs\n| filter event.provider==\"Falco\"\n| parse content, \"JSON:jsoncontent\"| fieldsAdd falcopriority=jsoncontent[severity]\n| summarize count(), by:{k8s.namespace.name}","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto"},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"categorical"},"histogram":{"dataMappings":[]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}},"7":{"type":"data","title":"mitre discovered","query":"fetch logs, from:now() - 72h \n| filter (event.provider == \"Falco\") \n| summarize { \n    num_tactics = countDistinct(mitre.tactic), \n    num_techniques = countDistinct(mitre.technique), \n    tactics = collectDistinct(mitre.tactic), \n    techniques = collectDistinct(mitre.technique) \n  }, by:{k8s.pod.name,content.output_fields.proc.name,k8s.namespace.name} \n| sort num_tactics desc, num_techniques desc","davis":{"enabled":false,"davisVisualization":{"isAvailable":true}},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"xAxisScaling":"analyzedTimeframe","gapPolicy":"gap","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"curve":"linear","pointsDisplay":"auto","truncationMode":"middle","categoricalBarChartSettings":{"categoryAxis":"k8s.pod.name","categoryAxisLabel":"k8s.pod.name","valueAxis":["num_tactics","num_techniques"],"valueAxisLabel":"num_tactics,num_techniques","tooltipVariant":"single"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","recordField":"k8s.pod.name","autoscale":true,"alignment":"center","colorThresholdTarget":"value"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"linewrapEnabled":false,"lineWrapIds":[],"monospacedFontEnabled":false,"monospacedFontColumns":[],"columnWidths":{},"columnTypeOverrides":[]},"honeycomb":{"shape":"hexagon","legend":{"hidden":false,"position":"auto"},"colorMode":"color-palette","colorPalette":"blue","dataMappings":{"value":"num_tactics"},"displayedFields":["k8s.pod.name","content.output_fields.proc.name","k8s.namespace.name"]},"histogram":{"dataMappings":[{"valueAxis":"num_tactics","rangeAxis":""},{"valueAxis":"num_techniques","rangeAxis":""}]}},"querySettings":{"maxResultRecords":1000,"defaultScanLimitGbytes":500,"maxResultMegaBytes":1,"defaultSamplingRatio":10,"enableSampling":false}}},"layouts":{"0":{"x":0,"y":0,"w":24,"h":1},"1":{"x":0,"y":1,"w":3,"h":6},"2":{"x":3,"y":1,"w":4,"h":6},"3":{"x":7,"y":1,"w":4,"h":6},"4":{"x":0,"y":8,"w":8,"h":8},"5":{"x":0,"y":7,"w":24,"h":1},"6":{"x":8,"y":8,"w":7,"h":8},"7":{"x":0,"y":16,"w":15,"h":9}},"importedWithCode":false}